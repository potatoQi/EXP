# å·¥ä½œæµçš„åç§°,ä¼šæ˜¾ç¤ºåœ¨ GitHub Actions é¡µé¢ä¸Š
name: ğŸ§ª Tests

# å®šä¹‰è§¦å‘æ­¤å·¥ä½œæµçš„äº‹ä»¶
on:
  push:  # å½“ä»£ç è¢«æ¨é€æ—¶è§¦å‘
    branches: [ main, dev ]  # ä»…é™ main å’Œ dev åˆ†æ”¯
  pull_request:  # å½“åˆ›å»ºæˆ–æ›´æ–° Pull Request æ—¶è§¦å‘
    branches: [ main ]  # ä»…é™ç›®æ ‡åˆ†æ”¯ä¸º main çš„ PR

# å®šä¹‰å·¥ä½œæµä¸­çš„æ‰€æœ‰ä»»åŠ¡(jobs)
jobs:
  test:  # ä»»åŠ¡ ID,å¯ä»¥è‡ªå®šä¹‰åç§°
    runs-on: ubuntu-latest  # æŒ‡å®šè¿è¡Œç¯å¢ƒä¸ºæœ€æ–°ç‰ˆ Ubuntu ç³»ç»Ÿ

    strategy:  # å®šä¹‰çŸ©é˜µç­–ç•¥,ç”¨äºåœ¨å¤šä¸ªé…ç½®ä¸‹è¿è¡Œä»»åŠ¡
      matrix:  # çŸ©é˜µé…ç½®
        python-version: ['3.9', '3.10', '3.11', '3.12']  # å®šä¹‰å¤šä¸ª Python ç‰ˆæœ¬, å·¥ä½œæµä¼šä¸ºæ¯ä¸ªç‰ˆæœ¬è¿è¡Œä¸€æ¬¡

    steps:  # å®šä¹‰ä»»åŠ¡ä¸­çš„å…·ä½“æ‰§è¡Œæ­¥éª¤
    - name: ğŸ“¥ æ£€å‡ºä»£ç   # æ­¥éª¤çš„æè¿°åç§°
      uses: actions/checkout@v4  # ä½¿ç”¨å®˜æ–¹ checkout action ä»ä»“åº“æ‹‰å–ä»£ç ,v4 æ˜¯ç‰ˆæœ¬å·

    - name: ğŸ è®¾ç½® Python ${{ matrix.python-version }}  # ${{ }} æ˜¯æ¨¡æ¿è¯­æ³•,å¼•ç”¨ matrix ä¸­å®šä¹‰çš„ Python ç‰ˆæœ¬
      uses: actions/setup-python@v4  # ä½¿ç”¨å®˜æ–¹ setup-python action å®‰è£… Python
      with:  # ä¼ é€’å‚æ•°ç»™è¿™ä¸ª action
        python-version: ${{ matrix.python-version }}  # æŒ‡å®šè¦å®‰è£…çš„ Python ç‰ˆæœ¬

    - name: ğŸ“¦ å®‰è£…ä¾èµ–  # å®‰è£…é¡¹ç›®æ‰€éœ€çš„ Python åŒ…
      run: |  # run å…³é”®å­—åé¢è·Ÿ shell å‘½ä»¤,| è¡¨ç¤ºå¤šè¡Œå‘½ä»¤
        python -m pip install --upgrade pip  # å…ˆå‡çº§ pip åˆ°æœ€æ–°ç‰ˆæœ¬
        pip install -e .[dev]  # ä»¥å¯ç¼–è¾‘æ¨¡å¼å®‰è£…å½“å‰é¡¹ç›®åŠå…¶ dev ä¾èµ–

    - name: ğŸ§ª è¿è¡Œæµ‹è¯•  # æ‰§è¡Œæµ‹è¯•ç”¨ä¾‹
      run: |  # è¿è¡Œ pytest æµ‹è¯•æ¡†æ¶
        pytest -v --tb=short  # -v è¯¦ç»†è¾“å‡º,--tb=short ç®€çŸ­çš„é”™è¯¯å›æº¯ä¿¡æ¯